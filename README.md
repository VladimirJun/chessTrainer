# Описание части проекта, выполненного в рамках БММ-2024
Model.py - экспорт партий с lichess.org и анализ этих партий с последующей записью в базу

Chess_data.csv - база проанализированных партий

chess-rating_model.pkl  - обученная модель
scaker.pkl - skaler


TrainModel.py - создание и обучение модели, предсказывающей рейтинг пользователя на основе силы сделанных им ходов.
Модель обучена с помощью XGBoost, т.к. принцип линейной регрессии плохо реагировал на партии-перфомансы(1000 рейтинга игра 95 процентов по первой линии, как пример)


Game.py - непосредственно игровая часть, где создается полноценная шахматная доска и по ходу партии вычисляется сила хода.
На основе процентного соотношения ходов по первой, второй, третьей линии и плохих ходов происходит оценка примерного рейтинга игрока.
На основе предсказанного рейтинга устанавливается уровень игры шахматного движка (Stockfish 16)
   process_user_move(move) - анализирует сделанный ход
   evaluate_game() - предсказывает примерный рейтинг на основе сделанных пользователем ходов.

Добавлена логика игры за оба цвета и простой интерфейс для презентации

Запуск проекта локально:
1) Установка движка (stockfish 16)
2) Скачивание необходимых изображений шахматных фигур
3) Изменение путей к движку и изображениям в файле config.properties
4) Запуск файла Game.py
# Информация о запуске приложения
./API - пакет с созданным API, со следующими возможностями: - юзер: id, рейтинг (может быть 0, тогда надо рассчитывать с нуля), массив прошлых поединков в формате PGN (может быть пустой)
- создать новый матч, завершить матч (получив обновленный рейтинг)
- добавить ход к матчу, получить ответный ход и обновленный рейтинг
API/Controlers - контролеры для обработки запросов
API/services - сервисы для обработки бизнес-логики 
API/Models - модели сущностей (Игрок и Матч)
API/repos - репозитории для бд
/data_base - пакет с файлами БД
application.py - файл с инициализацией fastAPI приложения
ChessAI/requirements.txt - список необходимых пакетов в проекте
main_server.py - файл для запуска.
## Инструкция для запуска
1) Склонировать репозиторий git (git clone https://gitlab.com/cidious/coronachess-ai.git)
2) Выполнить команду git pull origin dev (получение рабочей ветки)
2) Перейти в корень проекта
3) В терминале выполнить команду chmod +x setup_and_start.sh
4) В корне проекта прописать команду bash setup_and_start.sh (установит все необходимые зависимости для фронтенда и бэкэнда, создаст venv)
5) В поле id ввести 17 (тестовый игрок, добавлю регистрацию нового игрока при необходимости)
## Инструкция по установке и сборке движка Stockfish
Перед началом убедиться, что компиляторы gcc и g++, а также система сборки версий make установлены.
1) Перейти по ссылке и установить архив с исходным кодом https://github.com/official-stockfish/Stockfish/releases/tag/sf_11
2) Распаковать в любую удобную папку в проекте
3) перейти в папку ./Stockfish-sf_11
4) Запустить сборку движка командой make build ARCH=x86-64 COMP=mingw
После этих шагов командой ls проверить, что в текущей директории появился файл stockfish.exe

